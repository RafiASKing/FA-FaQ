version: '3'

services:
  # --- SERVICE 1: USER APP (Port 8501) ---
  faq-user:
    build: .
    container_name: faq_user_app
    restart: always
    ports:
      - "8501:8501"
    volumes:
      - ./data:/app/data
      - ./images:/app/images
      - ./.streamlit:/app/.streamlit
    env_file: .env
    command: streamlit run app.py --server.port=8501 --server.address=0.0.0.0

  # --- SERVICE 2: ADMIN APP (Port 8502) ---
  faq-admin:
    build: .
    container_name: faq_admin_app
    restart: always
    ports:
      - "8502:8502"
    volumes:
      - ./data:/app/data
      - ./images:/app/images
      - ./.streamlit:/app/.streamlit
    env_file: .env
    command: streamlit run admin.py --server.port=8502 --server.address=0.0.0.0

  # --- SERVICE 3: WHATSAPP BOT (Port 8000) ---
  faq-bot:
    build: .
    container_name: faq_bot_wa
    restart: always
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
      - ./images:/app/images
    env_file: .env
    # Menjalankan FastAPI dengan Uvicorn
    command: uvicorn bot_wa:app --host 0.0.0.0 --port 8000